<?php include_once "php/censor.php"; ?>
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Project Anima - Commentaires</title>
  <link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #0d0d0d;
      color: #eee;
      font-family: 'Special Elite', cursive;
      margin: 0;
      padding: 0;
    }
    header {
      background: #000;
      padding: 0;
      text-align: center;
    }
    header img {
      width: 100%;
      height: auto;
      max-height: 120px;
      object-fit: contain;
    }
    nav {
      background-color: #111;
      padding: 10px 0;
      text-align: center;
      width: 100%;
    }
    nav a {
      color: crimson;
      margin: 0 8px;
      text-decoration: none;
      font-family: 'Special Elite', cursive;
      font-size: 16px;
      font-weight: bold;
      display: inline-block;
    }
    main {
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    form {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    input, textarea {
      padding: 10px;
      font-family: 'Special Elite', cursive;
      background-color: #111;
      border: 1px solid crimson;
      color: #eee;
    }
    input[type="submit"] {
      background-color: crimson;
      color: white;
      border: none;
      cursor: pointer;
    }
    input[type="submit"]:hover {
      background-color: darkred;
    }
    .comment-section {
      margin-top: 40px;
    }
    .comment {
      border-left: 3px solid crimson;
      padding-left: 10px;
      margin-bottom: 20px;
    }
    footer {
      text-align: center;
      color: #444;
      font-size: 14px;
      padding: 20px;
    }
  </style>
</head>
<body>
  <header>
    <img src="img/banner.jpg" alt="Bannière du jeu">
  </header>
  <nav>
    <a href="index.php">Accueil</a>
    <a href="update.php">Mise à jour</a>
    <a href="info.php">Information</a>
    <a href="images.php">Images</a>
    <a href="video.php">Vidéos</a>
    <a href="download.php">Télécharger</a>
    <a href="contact.php">Contact</a>
    <a href="comments.php">Commentaires</a>
    <a href="chat.php">Chat</a>
  </nav>
  <main>
    <h1>Commentaires des joueurs</h1>
    <p>Des récompenses comme des images ou vidéos exclusives pourraient être envoyées à l’adresse fournie.</p>
    <p>Utilisez un vrai email pour ne rien manquer.</p>
    <form action="php/submit_comment.php" method="POST">
      <input type="email" name="email" placeholder="Votre email" required>
      <textarea name="comment" placeholder="Votre commentaire..." rows="4" required></textarea>
      <input type="submit" value="Envoyer le commentaire">
    </form>

    <div class="comment-section">
      <h2>Commentaires récents</h2>
      <?php
        $conn = new mysqli('localhost', 'root', '', 'project_anima');
        if ($conn->connect_error) {
          echo '<p>Erreur de connexion à la base de données.</p>';
        } else {
          $result = $conn->query("SELECT email, content, created_at FROM comments ORDER BY created_at DESC LIMIT 10");
          while ($row = $result->fetch_assoc()) {
            echo '<div class="comment">';
            echo '<p><strong>' . htmlspecialchars($row['email']) . '</strong> <em>(' . $row['created_at'] . ')</em></p>';
            echo '<p>' . nl2br(htmlspecialchars(censor_text($row['content']))) . '</p>';
            echo '</div>';
          }
          $conn->close();
        }
      ?>
    </div>
  </main>
  <footer>
    &copy; 2025 Project Anima. Tous droits réservés.
  </footer>
</body>
</html>
